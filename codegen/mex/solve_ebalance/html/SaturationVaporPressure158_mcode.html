<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="51,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">vp</span> ] = SaturationVaporPressure( <span class="var type1" id="S3T1U6">T</span>, <span class="var type2" id="S4T8V1U7">substance</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="51,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%SatVP saturation vapor pressure over water or ice</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% [ vp ] = SaturationVaporPressure( T, substance )</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% input</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%   T - Kelvin temperature, can be a vector or matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%   substance - either 'ice' or 'water'</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% output</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,10" id="srcline10">10</a></span><span class="line"><span class="comment">%   vp - saturation vapor pressure(s) in kPa corresponding to temperature(s)</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,11" id="srcline11">11</a></span><span class="line"><span class="comment">%   (set to NaN where substance is 'ice' and T&gt;273.16</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,12" id="srcline12">12</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,13" id="srcline13">13</a></span><span class="line"><span class="comment">% Equations are from Bohren, C. F., and B. A. Albrecht (1998),</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,14" id="srcline14">14</a></span><span class="line"><span class="comment">% Atmospheric Thermodynamics, Oxford University Press.</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,17" id="srcline17">17</a></span><span class="line">assert(<span class="mxinfo " id="T2:U4">strcmpi(<span class="var type1" id="S4T8U14">substance</span>,<span class="string">'ice'</span>) || strcmpi(<span class="var type1" id="S4T8U18">substance</span>,<span class="string">'water'</span>)</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,18" id="srcline18">18</a></span><span class="line">    <span class="string">'substance (2nd argument) must be either ''ice'' or ''water'''</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="51,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T23:U7"><span class="extrinsicFcn" id="F804N8:B23">assert</span>(<span class="mxinfo " id="T2:U8"><span class="mxinfo " id="T1:U9">single(<span class="mxinfo " id="T6:U10">nnz(<span class="mxinfo " id="T17:U11"><span class="var type1" id="S3T1U30">T</span>(<span class="mxinfo " id="T2:U13"><span class="var type1" id="S3T1U32">T</span>&lt;<span class="mxinfo " id="T1:U15">0</span></span>)</span>)</span>)</span> == <span class="mxinfo " id="T1:U16">0</span></span>, <span class="mxinfo " id="T19:U17"><span class="string">'Temperatures must be in Kelvin'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T1:U18"><span class="var type1" id="S9T1U38">T0</span> = <span class="mxinfo " id="T1:U20">273.16</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S10T1U42">es0</span> = <span class="mxinfo " id="T1:U23">0.611</span></span>; <span class="comment">% sat vp in kPa at 273.16K</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,23" id="srcline23">23</a></span><span class="line"><span class="keyword">if</span> strcmpi(<span class="var type1" id="S4T8U48">substance</span>,<span class="string">'ice'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="51,24" id="srcline24">24</a></span><span class="line">    <span class="var type0" id="S11T0U52">logs</span> = 6293.*(1/<span class="var type0" id="S9T0U60">T0</span> - 1./<span class="var type0" id="S3T0U63">T</span>) - 0.555*log(<span class="var type0" id="S3T0U69">T</span>/<span class="var type0" id="S9T0U70">T0</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="51,25" id="srcline25">25</a></span><span class="line">    <span class="var type0" id="S13T0U73">ok</span> = <span class="var type0" id="S3T0U75">T</span> &lt;= <span class="var type0" id="S9T0U76">T0</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> single(nnz(~<span class="var type0" id="S13T0U85">ok</span>))&gt;0</span></span>
<span class="srcline"><span class="lineno"><a href="51,27" id="srcline27">27</a></span><span class="line">        <span class="var type0" id="S11T0U90">logs</span>(~<span class="var type0" id="S13T0U92">ok</span>) = NaN;</span></span>
<span class="srcline"><span class="lineno"><a href="51,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,29" id="srcline29">29</a></span><span class="line"><span class="keyword">else</span> <span class="comment">% water</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T1:U25"><span class="var type1" id="S11T1U98">logs</span> = <span class="mxinfo " id="T1:U27"><span class="mxinfo " id="T1:U28">6808.*(<span class="mxinfo " id="T1:U29">1/<span class="var type1" id="S9T1U106">T0</span> - <span class="mxinfo " id="T1:U31"><span class="mxinfo " id="T1:U32">1</span>./<span class="var type1" id="S3T1U109">T</span></span></span>)</span> - <span class="mxinfo " id="T1:U34">5.09*<span class="mxinfo " id="T1:U35">log(<span class="mxinfo " id="T1:U36"><span class="var type1" id="S3T1U115">T</span>/<span class="var type1" id="S9T1U116">T0</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,31" id="srcline31">31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T1:U39"><span class="var type1" id="S2T1U119">vp</span> = <span class="mxinfo " id="T1:U41"><span class="var type1" id="S10T1U121">es0</span> * <span class="mxinfo " id="T1:U43">exp(<span class="var type1" id="S11T1U124">logs</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="51,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="51,34" id="srcline34">34</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="51,35" id="srcline35">35</a></span><span class="line"></span></span>
</pre>
</body>
</html>
