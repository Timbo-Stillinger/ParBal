<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="76,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">d</span>,<span class="var type1" id="S3T1U4">LinZ</span>,<span class="var type1" id="S4T1U5">Lout</span>,<span class="var type1" id="S5T1U6">sensible</span>,<span class="var type1" id="S6T1U7">G</span>]=solve_debris_depth(<span class="var type1" id="S7T1U10">Lin_coarse</span>,<span class="var type1" id="S8T1U11">Zdiff</span>,<span class="var type1" id="S9T1U12">T_fine</span>,<span class="var type1" id="S10T1U13">Vf</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,2" id="srcline2"> 2</a></span><span class="line">    <span class="var type1" id="S11T1U14">albedo</span>,<span class="var type1" id="S12T1U15">Sin</span>,<span class="var type1" id="S13T1U16">Tsfc</span>,<span class="var type1" id="S14T1U17">sig</span>,<span class="var type1" id="S15T1U18">ems</span>,<span class="var type1" id="S16T1U19">rho_air</span>,<span class="var type1" id="S17T1U20">Cp</span>,<span class="var type1" id="S18T1U21">De_h</span>,<span class="var type1" id="S19T1U22">K</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="76,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%solve for dry debris depth d at one time using inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%Lin_coarse, coarse  incoming longwave, W/m^2</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%Zdiff, difference between fine and coarse elevation, corresponding to</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%Lin_coarse</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%T_fine, fine air temp, K</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%Vf, view factor, 0-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%albedo, debris albedo, 0-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,10" id="srcline10">10</a></span><span class="line"><span class="comment">%pres_fine, fine_scale atmos pressure, kPa</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,11" id="srcline11">11</a></span><span class="line"><span class="comment">%ea, vapor pressure of air</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,12" id="srcline12">12</a></span><span class="line"><span class="comment">%Tsfc, debris surface temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,13" id="srcline13">13</a></span><span class="line"><span class="comment">%sig, steffan boltzman constant</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,14" id="srcline14">14</a></span><span class="line"><span class="comment">%ems, emissivity of debris (i.e. 0.94 for metamorphic rock &amp;</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,15" id="srcline15">15</a></span><span class="line"><span class="comment">%granite)</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,16" id="srcline16">16</a></span><span class="line"><span class="comment">%Cp, specific heat of air, J/(kg deg)</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,17" id="srcline17">17</a></span><span class="line"><span class="comment">%De_h, sensible heat exchange coefficient, m/sec</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,18" id="srcline18">18</a></span><span class="line"><span class="comment">%K, conducitivity of debris, W/(m*K), e.g. 1 W/(m*K) is mean from</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,19" id="srcline19">19</a></span><span class="line"><span class="comment">%Schauwecker et al 2015 Table 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,20" id="srcline20">20</a></span><span class="line"><span class="comment">%output</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,21" id="srcline21">21</a></span><span class="line"><span class="comment">%d - debris depth, m</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="76,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S3T1U25">LinZ</span>=<span class="mxinfo " id="T1:U21"><span class="fcn" id="F402N10:B27">lapseLongWave</span>(<span class="var type1" id="S7T1U28">Lin_coarse</span>,<span class="var type1" id="S8T1U29">Zdiff</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,24" id="srcline24">24</a></span><span class="line"><span class="comment">% adjust for surrounding terrain</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T1:U24"><span class="var type1" id="S4T1U32">Lout</span> = <span class="mxinfo " id="T1:U26">-(<span class="mxinfo " id="T1:U27"><span class="mxinfo " id="T1:U28"><span class="var type1" id="S15T1U37">ems</span>.*<span class="var type1" id="S14T1U38">sig</span></span>.*<span class="mxinfo " id="T1:U31"><span class="var type1" id="S13T1U40">Tsfc</span>.^4</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S21T1U44">LinT</span> = <span class="mxinfo " id="T1:U35"><span class="mxinfo " id="T1:U36"><span class="var type1" id="S10T1U47">Vf</span>.* <span class="var type1" id="S3T1U48">LinZ</span></span> + <span class="mxinfo " id="T1:U39">(<span class="mxinfo " id="T1:U40">1-<span class="var type1" id="S10T1U53">Vf</span></span>).*<span class="var type1" id="S4T1U54">Lout</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T1:U43"><span class="var type1" id="S22T1U57">Lnet</span>=<span class="mxinfo " id="T1:U45"><span class="var type1" id="S21T1U59">LinT</span>+<span class="var type1" id="S4T1U60">Lout</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T1:U48"><span class="var type1" id="S23T1U63">Snet</span>=<span class="mxinfo " id="T1:U50"><span class="var type1" id="S12T1U65">Sin</span>*(<span class="mxinfo " id="T1:U52">1-<span class="var type1" id="S11T1U69">albedo</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,29" id="srcline29">29</a></span><span class="line"><span class="comment">% assume a neutral atmosphere (stability = 1). See Rounce and McKiney 2014</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T1:U54"><span class="var type1" id="S24T1U72">stability</span> = <span class="mxinfo " id="T1:U56">single(1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T1:U57"><span class="var type1" id="S5T1U78">sensible</span>=<span class="mxinfo " id="T1:U59"><span class="mxinfo " id="T1:U60"><span class="mxinfo " id="T1:U61"><span class="mxinfo " id="T1:U62"><span class="var type1" id="S16T1U83">rho_air</span>.*<span class="var type1" id="S17T1U84">Cp</span></span>.*<span class="var type1" id="S18T1U85">De_h</span></span>.*<span class="var type1" id="S24T1U86">stability</span></span>.*(<span class="mxinfo " id="T1:U67"><span class="var type1" id="S9T1U89">T_fine</span>-<span class="var type1" id="S13T1U90">Tsfc</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,32" id="srcline32">32</a></span><span class="line"><span class="comment">% debris is dry during Tsfc aquisitions so latent = 0.</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,33" id="srcline33">33</a></span><span class="line"><span class="comment">% use iterative approach of Schauwecker et al 2015</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T1:U70"><span class="var type1" id="S26T1U93">num_tries</span> = <span class="mxinfo " id="T1:U72">20</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U73"><span class="var type1" id="S27T1U97">d0</span> = <span class="mxinfo " id="T1:U75">0.45</span></span>; <span class="comment">%m, initial guess</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T1:U76"><span class="var type1" id="S28T1U101">thresh</span> = <span class="mxinfo " id="T1:U78">1e-3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,37" id="srcline37">37</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S29T1U105">i</span>=<span class="mxinfo " id="T1:U80"><span class="mxinfo " id="T1:U81">1</span>:<span class="var type1" id="S26T1U108">num_tries</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="76,38" id="srcline38">38</a></span><span class="line">    <span class="mxinfo " id="T1:U83"><span class="var type1" id="S30T1U111">F</span> = <span class="mxinfo " id="T1:U85"><span class="mxinfo " id="T1:U86">6.17*<span class="var type1" id="S27T1U115">d0</span></span>+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,39" id="srcline39">39</a></span><span class="line">    <span class="mxinfo " id="T1:U88"><span class="var type1" id="S2T1U119">d</span> = <span class="mxinfo " id="T1:U90"><span class="mxinfo " id="T1:U91"><span class="mxinfo " id="T1:U92">(<span class="mxinfo " id="T1:U93"><span class="mxinfo " id="T1:U94">(<span class="mxinfo " id="T1:U95">1+<span class="var type1" id="S30T1U129">F</span></span>).*<span class="var type1" id="S19T1U130">K</span></span>.*(<span class="mxinfo " id="T1:U98"><span class="var type1" id="S13T1U133">Tsfc</span>-273.15</span>)</span>)./(<span class="mxinfo " id="T1:U100"><span class="mxinfo " id="T1:U101"><span class="var type1" id="S23T1U138">Snet</span>+<span class="var type1" id="S22T1U139">Lnet</span></span>+<span class="var type1" id="S5T1U140">sensible</span></span>)</span>.*1</span>/0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,40" id="srcline40">40</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T2:U105"><span class="mxinfo " id="T1:U106">abs(<span class="mxinfo " id="T1:U107"><span class="var type1" id="S2T1U149">d</span>-<span class="var type1" id="S27T1U150">d0</span></span>)</span> &lt; <span class="var type1" id="S28T1U151">thresh</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="76,41" id="srcline41">41</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,42" id="srcline42">42</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,43" id="srcline43">43</a></span><span class="line">    <span class="mxinfo " id="T1:U111"><span class="var type1" id="S27T1U155">d0</span> = <span class="var type1" id="S2T1U156">d</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,44" id="srcline44">44</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,45" id="srcline45">45</a></span><span class="line"><span class="comment">%if d is negative or didn't converge</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,46" id="srcline46">46</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T2:U114"><span class="var type1" id="S2T1U161">d</span> &lt; <span class="mxinfo " id="T1:U116">0</span></span> || <span class="mxinfo " id="T2:U117"><span class="var type1" id="S29T1U164">i</span>==<span class="var type1" id="S26T1U165">num_tries</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="76,47" id="srcline47">47</a></span><span class="line">    <span class="mxinfo " id="T1:U120"><span class="var type1" id="S2T1U168">d</span>=<span class="mxinfo " id="T1:U122">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="76,48" id="srcline48">48</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,49" id="srcline49">49</a></span><span class="line"><span class="comment">%Schauwecker et al 2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="76,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo " id="T1:U123"><span class="var type1" id="S6T1U173">G</span>=<span class="mxinfo " id="T1:U125">(<span class="mxinfo " id="T1:U126"><span class="var type1" id="S19T1U177">K</span>.*(<span class="mxinfo " id="T1:U128"><span class="var type1" id="S13T1U180">Tsfc</span>-273.15</span>)</span>)/(<span class="mxinfo " id="T1:U130">0.5*<span class="var type1" id="S2T1U185">d</span></span>)</span></span>;</span></span>
</pre>
</body>
</html>
