<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="81,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">dM</span>=d_ebalance(<span class="var type1" id="S3T1U6">Tsfc</span>,<span class="var type1" id="S4T1U7">T_fine</span>,<span class="var type1" id="S5T1U8">Vf</span>,<span class="var type1" id="S6T1U9">pres_fine</span>,<span class="var type1" id="S7T1U10">ea</span>,<span class="var type1" id="S8T1U11">sig</span>,<span class="var type1" id="S9T5U12">emissivity</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,2" id="srcline2"> 2</a></span><span class="line">    <span class="var type1" id="S10T1U13">Cp</span>,<span class="var type1" id="S11T1U14">xLs</span>,<span class="var type1" id="S12T1U15">rho_air</span>,<span class="var type1" id="S13T1U16">De_h</span>,<span class="var type1" id="S14T1U17">B1</span>,<span class="var type1" id="S15T1U18">B2</span>,<span class="var type1" id="S16T1U19">tau</span>,<span class="var type1" id="S17T1U20">cc</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="81,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% cc=FOREST.cc;</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% tau=FOREST.tau;</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T1:U17"><span class="var type1" id="S18T1U23">ems</span>=<span class="mxinfo " id="T1:U19"><span class="var type1" id="S9T5U25">emissivity</span>.ems</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%analytical deriative of L</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S19T1U29">dL</span>=<span class="mxinfo " id="T1:U23"><span class="mxinfo " id="T1:U24"><span class="mxinfo " id="T1:U25"><span class="mxinfo " id="T1:U26">-4*<span class="mxinfo " id="T1:U27"><span class="var type1" id="S3T1U37">Tsfc</span>^3</span></span>*<span class="var type1" id="S18T1U39">ems</span></span>*<span class="var type1" id="S8T1U40">sig</span></span>*(<span class="mxinfo " id="T1:U31"><span class="mxinfo " id="T1:U32"><span class="mxinfo " id="T1:U33"><span class="mxinfo " id="T1:U34"><span class="mxinfo " id="T1:U35"><span class="mxinfo " id="T1:U36"><span class="mxinfo " id="T1:U37"><span class="var type1" id="S5T1U49">Vf</span>*<span class="var type1" id="S18T1U50">ems</span></span> - <span class="var type1" id="S18T1U51">ems</span></span> + <span class="mxinfo " id="T1:U41"><span class="var type1" id="S17T1U53">cc</span>*<span class="var type1" id="S18T1U54">ems</span></span></span> - <span class="mxinfo " id="T1:U44"><span class="mxinfo " id="T1:U45"><span class="var type1" id="S5T1U57">Vf</span>*<span class="var type1" id="S17T1U58">cc</span></span>*<span class="var type1" id="S18T1U59">ems</span></span></span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T1:U49"><span class="mxinfo " id="T1:U50"><span class="var type1" id="S17T1U62">cc</span>*<span class="var type1" id="S18T1U63">ems</span></span>*<span class="var type1" id="S16T1U64">tau</span></span></span> + <span class="mxinfo " id="T1:U54"><span class="mxinfo " id="T1:U55"><span class="mxinfo " id="T1:U56"><span class="var type1" id="S5T1U68">Vf</span>*<span class="var type1" id="S17T1U69">cc</span></span>*<span class="var type1" id="S18T1U70">ems</span></span>*<span class="var type1" id="S16T1U71">tau</span></span></span> + 1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%analytical derivative of T=latent+sensible given unstable</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,10" id="srcline10">10</a></span><span class="line"><span class="comment">%conditions (Tsfc &gt; Tair)</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,11" id="srcline11">11</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T2:U61"><span class="var type1" id="S3T1U76">Tsfc</span> &gt; <span class="var type1" id="S4T1U77">T_fine</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T1:U64"><span class="var type1" id="S20T1U80">dT</span> = <span class="mxinfo " id="T1:U66"><span class="mxinfo " id="T1:U67"><span class="mxinfo " id="T1:U68"><span class="mxinfo " id="T1:U69"><span class="mxinfo " id="T1:U70"><span class="mxinfo " id="T1:U71"><span class="var type1" id="S10T1U87">Cp</span>*<span class="var type1" id="S13T1U88">De_h</span></span>*<span class="var type1" id="S12T1U89">rho_air</span></span>*(<span class="mxinfo " id="T1:U75"><span class="mxinfo " id="T1:U76">(<span class="mxinfo " id="T1:U77"><span class="var type1" id="S14T1U95">B1</span>*(<span class="mxinfo " id="T1:U79"><span class="var type1" id="S4T1U98">T_fine</span> - <span class="var type1" id="S3T1U99">Tsfc</span></span>)</span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,13" id="srcline13">13</a></span><span class="line">        (<span class="mxinfo " id="T1:U82"><span class="mxinfo " id="T1:U83"><span class="var type1" id="S15T1U103">B2</span>*<span class="mxinfo " id="T1:U85">(<span class="mxinfo " id="T1:U86"><span class="var type1" id="S3T1U107">Tsfc</span> - <span class="var type1" id="S4T1U108">T_fine</span></span>)^(1/2)</span></span> + 1</span>)</span> - 1</span>)</span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo " id="T1:U89"><span class="mxinfo " id="T1:U90"><span class="mxinfo " id="T1:U91"><span class="mxinfo " id="T1:U92"><span class="var type1" id="S10T1U119">Cp</span>*<span class="var type1" id="S13T1U120">De_h</span></span>*<span class="var type1" id="S12T1U121">rho_air</span></span>*(<span class="mxinfo " id="T1:U96"><span class="var type1" id="S4T1U124">T_fine</span> - <span class="var type1" id="S3T1U125">Tsfc</span></span>)</span>*<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,15" id="srcline15">15</a></span><span class="line">        (<span class="mxinfo " id="T1:U99"><span class="mxinfo " id="T1:U100"><span class="var type1" id="S14T1U129">B1</span>/(<span class="mxinfo " id="T1:U102"><span class="mxinfo " id="T1:U103"><span class="var type1" id="S15T1U133">B2</span>*<span class="mxinfo " id="T1:U105">(<span class="mxinfo " id="T1:U106"><span class="var type1" id="S3T1U137">Tsfc</span> - <span class="var type1" id="S4T1U138">T_fine</span></span>)^(1/2)</span></span> + 1</span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,16" id="srcline16">16</a></span><span class="line">        <span class="mxinfo " id="T1:U109">(<span class="mxinfo " id="T1:U110"><span class="mxinfo " id="T1:U111"><span class="var type1" id="S14T1U148">B1</span>*<span class="var type1" id="S15T1U149">B2</span></span>*<span class="mxinfo " id="T1:U114">(<span class="mxinfo " id="T1:U115"><span class="var type1" id="S3T1U153">Tsfc</span> - <span class="var type1" id="S4T1U154">T_fine</span></span>)^(1/2)</span></span>)/(<span class="mxinfo " id="T1:U118">2*<span class="mxinfo " id="T1:U119">(<span class="mxinfo " id="T1:U120"><span class="mxinfo " id="T1:U121"><span class="var type1" id="S15T1U166">B2</span>*<span class="mxinfo " id="T1:U123">(<span class="mxinfo " id="T1:U124"><span class="var type1" id="S3T1U170">Tsfc</span> - <span class="var type1" id="S4T1U171">T_fine</span></span>)^(1/2)</span></span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,17" id="srcline17">17</a></span><span class="line">        + 1</span>)^2</span></span>)</span></span>)</span></span> + <span class="mxinfo " id="T1:U127">(<span class="mxinfo " id="T1:U128"><span class="mxinfo " id="T1:U129"><span class="mxinfo " id="T1:U130"><span class="mxinfo " id="T1:U131"><span class="mxinfo " id="T1:U132">311*<span class="var type1" id="S13T1U186">De_h</span></span>*<span class="var type1" id="S12T1U187">rho_air</span></span>*<span class="var type1" id="S11T1U188">xLs</span></span>*(<span class="mxinfo " id="T1:U136"><span class="var type1" id="S7T1U191">ea</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo " id="T1:U138">(<span class="mxinfo " id="T1:U139">12223*<span class="mxinfo " id="T1:U140">exp(<span class="mxinfo " id="T1:U141">(<span class="mxinfo " id="T1:U142"><span class="mxinfo " id="T1:U143">(<span class="mxinfo " id="T1:U144">5613*<span class="var type1" id="S3T1U205">Tsfc</span></span>)/250</span> - 6.1328e3</span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,19" id="srcline19">19</a></span><span class="line">        (<span class="mxinfo " id="T1:U146"><span class="var type1" id="S3T1U210">Tsfc</span> - 3/5</span>)</span>)</span></span>)/20</span></span>)</span>*(<span class="mxinfo " id="T1:U148"><span class="mxinfo " id="T1:U149"><span class="var type1" id="S14T1U218">B1</span>/(<span class="mxinfo " id="T1:U151"><span class="mxinfo " id="T1:U152"><span class="var type1" id="S15T1U222">B2</span>*<span class="mxinfo " id="T1:U154">(<span class="mxinfo " id="T1:U155"><span class="var type1" id="S3T1U226">Tsfc</span> - <span class="var type1" id="S4T1U227">T_fine</span></span>)^(1/2)</span></span> + 1</span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,20" id="srcline20">20</a></span><span class="line">        <span class="mxinfo " id="T1:U158">(<span class="mxinfo " id="T1:U159"><span class="mxinfo " id="T1:U160"><span class="var type1" id="S14T1U237">B1</span>*<span class="var type1" id="S15T1U238">B2</span></span>*<span class="mxinfo " id="T1:U163">(<span class="mxinfo " id="T1:U164"><span class="var type1" id="S3T1U242">Tsfc</span> - <span class="var type1" id="S4T1U243">T_fine</span></span>)^(1/2)</span></span>)/(<span class="mxinfo " id="T1:U167">2*<span class="mxinfo " id="T1:U168">(<span class="mxinfo " id="T1:U169"><span class="mxinfo " id="T1:U170"><span class="var type1" id="S15T1U255">B2</span>*<span class="mxinfo " id="T1:U172">(<span class="mxinfo " id="T1:U173"><span class="var type1" id="S3T1U259">Tsfc</span> - <span class="var type1" id="S4T1U260">T_fine</span></span>)^(1/2)</span></span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,21" id="srcline21">21</a></span><span class="line">        + 1</span>)^2</span></span>)</span></span>)</span>)/(<span class="mxinfo " id="T1:U176">500*<span class="var type1" id="S6T1U270">pres_fine</span></span>)</span></span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,22" id="srcline22">22</a></span><span class="line">        <span class="mxinfo " id="T1:U178">(<span class="mxinfo " id="T1:U179"><span class="mxinfo " id="T1:U180"><span class="mxinfo " id="T1:U181"><span class="mxinfo " id="T1:U182"><span class="mxinfo " id="T1:U183"><span class="mxinfo " id="T1:U184">3801353*<span class="var type1" id="S13T1U280">De_h</span></span>*<span class="var type1" id="S12T1U281">rho_air</span></span>*<span class="var type1" id="S11T1U282">xLs</span></span>*<span class="mxinfo " id="T1:U188">exp(<span class="mxinfo " id="T1:U189">(<span class="mxinfo " id="T1:U190"><span class="mxinfo " id="T1:U191">(<span class="mxinfo " id="T1:U192">5613*<span class="var type1" id="S3T1U292">Tsfc</span></span>)/250</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,23" id="srcline23">23</a></span><span class="line">        6.1328e3</span>)/(<span class="mxinfo " id="T1:U194"><span class="var type1" id="S3T1U297">Tsfc</span> - 3/5</span>)</span>)</span></span>*(<span class="mxinfo " id="T1:U196"><span class="mxinfo " id="T1:U197">5613/(<span class="mxinfo " id="T1:U198">250*(<span class="mxinfo " id="T1:U199"><span class="var type1" id="S3T1U310">Tsfc</span> - 3/5</span>)</span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T1:U201">(<span class="mxinfo " id="T1:U202"><span class="mxinfo " id="T1:U203">(<span class="mxinfo " id="T1:U204">5613*<span class="var type1" id="S3T1U321">Tsfc</span></span>)/250</span> - 6.1328e3</span>)/<span class="mxinfo " id="T1:U206">(<span class="mxinfo " id="T1:U207"><span class="var type1" id="S3T1U327">Tsfc</span> - 3/5</span>)^2</span></span></span>)</span>*<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,25" id="srcline25">25</a></span><span class="line">        (<span class="mxinfo " id="T1:U209"><span class="mxinfo " id="T1:U210">(<span class="mxinfo " id="T1:U211"><span class="var type1" id="S14T1U337">B1</span>*(<span class="mxinfo " id="T1:U213"><span class="var type1" id="S4T1U340">T_fine</span> - <span class="var type1" id="S3T1U341">Tsfc</span></span>)</span>)/(<span class="mxinfo " id="T1:U216"><span class="mxinfo " id="T1:U217"><span class="var type1" id="S15T1U345">B2</span>*<span class="mxinfo " id="T1:U219">(<span class="mxinfo " id="T1:U220"><span class="var type1" id="S3T1U349">Tsfc</span> - <span class="var type1" id="S4T1U350">T_fine</span></span>)^(1/2)</span></span> + 1</span>)</span> - 1</span>)</span>)<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,26" id="srcline26">26</a></span><span class="line">        /(<span class="mxinfo " id="T1:U223">10000*<span class="var type1" id="S6T1U360">pres_fine</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,27" id="srcline27">27</a></span><span class="line">    <span class="comment">%analytical derivative of T given stable conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,28" id="srcline28">28</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T2:U225"><span class="var type1" id="S3T1U363">Tsfc</span> &lt; <span class="var type1" id="S4T1U364">T_fine</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T1:U228"><span class="var type1" id="S20T1U367">dT</span> = <span class="mxinfo " id="T1:U230"><span class="mxinfo " id="T1:U231"><span class="mxinfo " id="T1:U232"><span class="mxinfo " id="T1:U233">(<span class="mxinfo " id="T1:U234"><span class="mxinfo " id="T1:U235"><span class="mxinfo " id="T1:U236"><span class="mxinfo " id="T1:U237"><span class="var type1" id="S14T1U377">B1</span>*<span class="var type1" id="S10T1U378">Cp</span></span>*<span class="var type1" id="S13T1U379">De_h</span></span>*<span class="var type1" id="S12T1U380">rho_air</span></span>*(<span class="mxinfo " id="T1:U242"><span class="var type1" id="S4T1U383">T_fine</span> - <span class="var type1" id="S3T1U384">Tsfc</span></span>)</span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,30" id="srcline30">30</a></span><span class="line">        <span class="mxinfo " id="T1:U245">(<span class="mxinfo " id="T1:U246"><span class="mxinfo " id="T1:U247">(<span class="mxinfo " id="T1:U248"><span class="var type1" id="S14T1U391">B1</span>*(<span class="mxinfo " id="T1:U250"><span class="var type1" id="S4T1U394">T_fine</span> - <span class="var type1" id="S3T1U395">Tsfc</span></span>)</span>)/2</span> + 1</span>)^3</span></span> - <span class="mxinfo " id="T1:U253">(<span class="mxinfo " id="T1:U254"><span class="mxinfo " id="T1:U255"><span class="var type1" id="S10T1U403">Cp</span>*<span class="var type1" id="S13T1U404">De_h</span></span>*<span class="var type1" id="S12T1U405">rho_air</span></span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,31" id="srcline31">31</a></span><span class="line">        <span class="mxinfo " id="T1:U259">(<span class="mxinfo " id="T1:U260"><span class="mxinfo " id="T1:U261">(<span class="mxinfo " id="T1:U262"><span class="var type1" id="S14T1U412">B1</span>*(<span class="mxinfo " id="T1:U264"><span class="var type1" id="S4T1U415">T_fine</span> - <span class="var type1" id="S3T1U416">Tsfc</span></span>)</span>)/2</span> + 1</span>)^2</span></span></span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,32" id="srcline32">32</a></span><span class="line">        <span class="mxinfo " id="T1:U267">(<span class="mxinfo " id="T1:U268"><span class="mxinfo " id="T1:U269"><span class="mxinfo " id="T1:U270"><span class="mxinfo " id="T1:U271"><span class="mxinfo " id="T1:U272">3801353*<span class="var type1" id="S13T1U428">De_h</span></span>*<span class="var type1" id="S12T1U429">rho_air</span></span>*<span class="var type1" id="S11T1U430">xLs</span></span>*<span class="mxinfo " id="T1:U276">exp(<span class="mxinfo " id="T1:U277">(<span class="mxinfo " id="T1:U278"><span class="mxinfo " id="T1:U279">(<span class="mxinfo " id="T1:U280">5613*<span class="var type1" id="S3T1U440">Tsfc</span></span>)/250</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,33" id="srcline33">33</a></span><span class="line">        6.1328e3</span>)/(<span class="mxinfo " id="T1:U282"><span class="var type1" id="S3T1U445">Tsfc</span> - 3/5</span>)</span>)</span></span>*(<span class="mxinfo " id="T1:U284"><span class="mxinfo " id="T1:U285">5613/(<span class="mxinfo " id="T1:U286">250*(<span class="mxinfo " id="T1:U287"><span class="var type1" id="S3T1U458">Tsfc</span> - 3/5</span>)</span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,34" id="srcline34">34</a></span><span class="line">        <span class="mxinfo " id="T1:U289">(<span class="mxinfo " id="T1:U290"><span class="mxinfo " id="T1:U291">(<span class="mxinfo " id="T1:U292">5613*<span class="var type1" id="S3T1U469">Tsfc</span></span>)/250</span> - 6.1328e3</span>)/<span class="mxinfo " id="T1:U294">(<span class="mxinfo " id="T1:U295"><span class="var type1" id="S3T1U475">Tsfc</span> - 3/5</span>)^2</span></span></span>)</span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,35" id="srcline35">35</a></span><span class="line">        (<span class="mxinfo " id="T1:U297"><span class="mxinfo " id="T1:U298">10000*<span class="var type1" id="S6T1U484">pres_fine</span></span>*<span class="mxinfo " id="T1:U300">(<span class="mxinfo " id="T1:U301"><span class="mxinfo " id="T1:U302">(<span class="mxinfo " id="T1:U303"><span class="var type1" id="S14T1U491">B1</span>*(<span class="mxinfo " id="T1:U305"><span class="var type1" id="S4T1U494">T_fine</span> - <span class="var type1" id="S3T1U495">Tsfc</span></span>)</span>)/2</span> + 1</span>)^2</span></span>)</span></span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo " id="T1:U308">(<span class="mxinfo " id="T1:U309"><span class="mxinfo " id="T1:U310"><span class="mxinfo " id="T1:U311"><span class="mxinfo " id="T1:U312"><span class="mxinfo " id="T1:U313">311*<span class="var type1" id="S14T1U507">B1</span></span>*<span class="var type1" id="S13T1U508">De_h</span></span>*<span class="var type1" id="S12T1U509">rho_air</span></span>*<span class="var type1" id="S11T1U510">xLs</span></span>*(<span class="mxinfo " id="T1:U318"><span class="var type1" id="S7T1U513">ea</span> - <span class="mxinfo " id="T1:U320">(<span class="mxinfo " id="T1:U321">12223*<span class="mxinfo " id="T1:U322">exp(<span class="mxinfo " id="T1:U323">(<span class="mxinfo " id="T1:U324"><span class="mxinfo " id="T1:U325">(<span class="mxinfo " id="T1:U326">5613*<span class="var type1" id="S3T1U527">Tsfc</span></span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,37" id="srcline37">37</a></span><span class="line">        250</span> - 6.1328e3</span>)/(<span class="mxinfo " id="T1:U328"><span class="var type1" id="S3T1U532">Tsfc</span> - 3/5</span>)</span>)</span></span>)/20</span></span>)</span>)/(<span class="mxinfo " id="T1:U330"><span class="mxinfo " id="T1:U331">500*<span class="var type1" id="S6T1U541">pres_fine</span></span>*<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,38" id="srcline38">38</a></span><span class="line">        <span class="mxinfo " id="T1:U333">(<span class="mxinfo " id="T1:U334"><span class="mxinfo " id="T1:U335">(<span class="mxinfo " id="T1:U336"><span class="var type1" id="S14T1U548">B1</span>*(<span class="mxinfo " id="T1:U338"><span class="var type1" id="S4T1U551">T_fine</span> - <span class="var type1" id="S3T1U552">Tsfc</span></span>)</span>)/2</span> + 1</span>)^3</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,39" id="srcline39">39</a></span><span class="line"><span class="comment">%     analytical derivative of T given neutral conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,40" id="srcline40">40</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,41" id="srcline41">41</a></span><span class="line">    <span class="mxinfo " id="T1:U341"><span class="var type1" id="S20T1U559">dT</span>=<span class="mxinfo " id="T1:U343"><span class="mxinfo " id="T1:U344"><span class="mxinfo " id="T1:U345"><span class="mxinfo " id="T1:U346">- <span class="var type1" id="S10T1U564">Cp</span></span>*<span class="var type1" id="S13T1U565">De_h</span></span>*<span class="var type1" id="S12T1U566">rho_air</span></span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,42" id="srcline42">42</a></span><span class="line">        <span class="mxinfo " id="T1:U350">(<span class="mxinfo " id="T1:U351"><span class="mxinfo " id="T1:U352"><span class="mxinfo " id="T1:U353"><span class="mxinfo " id="T1:U354"><span class="mxinfo " id="T1:U355">3801353*<span class="var type1" id="S13T1U575">De_h</span></span>*<span class="var type1" id="S12T1U576">rho_air</span></span>*<span class="var type1" id="S11T1U577">xLs</span></span>*<span class="mxinfo " id="T1:U359">exp(<span class="mxinfo " id="T1:U360">(<span class="mxinfo " id="T1:U361"><span class="mxinfo " id="T1:U362">(<span class="mxinfo " id="T1:U363">5613*<span class="var type1" id="S3T1U587">Tsfc</span></span>)/250</span> - 6.1328e3</span>)/<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,43" id="srcline43">43</a></span><span class="line">        (<span class="mxinfo " id="T1:U365"><span class="var type1" id="S3T1U592">Tsfc</span> - 3/5</span>)</span>)</span></span>*(<span class="mxinfo " id="T1:U367"><span class="mxinfo " id="T1:U368">5613/(<span class="mxinfo " id="T1:U369">250*(<span class="mxinfo " id="T1:U370"><span class="var type1" id="S3T1U605">Tsfc</span> - 3/5</span>)</span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,44" id="srcline44">44</a></span><span class="line">        <span class="mxinfo " id="T1:U372">(<span class="mxinfo " id="T1:U373"><span class="mxinfo " id="T1:U374">(<span class="mxinfo " id="T1:U375">5613*<span class="var type1" id="S3T1U616">Tsfc</span></span>)/250</span> - 6.1328e3</span>)/<span class="mxinfo " id="T1:U377">(<span class="mxinfo " id="T1:U378"><span class="var type1" id="S3T1U622">Tsfc</span> - 3/5</span>)^2</span></span></span>)</span>)/(<span class="mxinfo " id="T1:U380">10000*<span class="var type1" id="S6T1U630">pres_fine</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,45" id="srcline45">45</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,46" id="srcline46">46</a></span><span class="line"><span class="comment">%total melt derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T1:U382"><span class="var type1" id="S2T1U633">dM</span>=<span class="mxinfo " id="T1:U384"><span class="var type1" id="S19T1U635">dL</span>+<span class="var type1" id="S20T1U636">dT</span></span></span>;<span class="comment">%;+dG;</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,48" id="srcline48">48</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
